---
title: 优雅，从系统开始（part 1）
date: 2024-10-2 10:05:16
categories:
  - 美化
  - Windows
tags:
  - 美化
  - 改造
time_warning: true
excerpt_type: text
---

## 前言

你是什么时候起，开始觉得 Windows 变得难看的？

<!-- more -->

作为从 XP、win7 时代走过来的人，我只是知道，以前的 Windows 并不是这样。

XP 也好，win7 也好，甚至于中间最遭人诟病的 vista，在设计语言上都有自己的特色，且基本能处处统一，作为一个完整的操作系统，整体性和连贯感都是在线的，性能表现在当年的硬件水平上也相当不俗……直到 win8 发布。

坦白说，在性能上， win8 倒也没什么可以指摘的地方，优化比 win7 更加激进，占用的资源也更少，流畅度也很高，但，外观上的崩坏从此时已经初见端倪——在 win8 的设计概念里，桌面相当于 metro 的一个 app，然而，这种设计变更在用户的感知中，几乎没有带来任何体验上的升级，只带来了割裂的桌面和开始屏幕，于是，微软在 win8.1 又识趣地改了回去。当然，我们知道，在一个层层迭代，需要考虑向下兼容和持久维护的系统中，反复修改 ui 和设计语言，只是在给未来的自己埋雷。果然，在屎山上拉屎的 win10 没过多久就把它给引爆了。

随着 win10 而来的是一种全新的设计语言：[流畅]{Fluent}[设计]{Design}^[Fluent Design 传承并发展了 win8 时期扁平化、色块化的设计语言，是 Modern Design Language 2 （MDL2）经过大幅度重设计后的版本，旨在带来具有光感、深度、动效、质感与缩放的元素。同时，它也带来了全新的光照效果和亚克力半透明背景。]，这种 UI 最早发布于 2017 年，之后在 Windows 10 1803 版本的更新中引入。

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021119627.png "win10 中 Fluent Design 的典型应用")

Fluent Design 本身确实大受好评，然而，记得我们之前说过的吗？ Windows 本身是一个需要考虑兼容性的复杂体系，以前的 ~~屎山~~ 组件不能随便乱改，什么？你说新 UI？不好意思，套壳吧，请（无慈悲）。

实际上， Windows 之前也一直是这么干的，只不过一路缝缝补补到了 win10，终于还是量变引起了质变。

win10 的 UI 设计混乱到什么地步呢？我们拿一种具体的颜色来说吧——白色。你可以试试在 win10 系统默认设置下，用截屏取色工具提取桌面右键菜单的背景白色、任务栏右键菜单的背景白色、任务管理器的背景白色，做一下对比，你会发现， **光是用于背景填充的白色，居然就有三个不同的色值！** 原因也很简单，这些组件分别来自不同的年代，套了不同层数的壳，于是最终以或复古，或割裂的色彩设计出现在 Windows 当时最新的系统里。

如果你以为 win10 只有这种程度，那你显然是低估了 Windows 的悠久历史。实际上，已经有人在 win10 凑齐了从 windows3.x 时代至今的所有 UI 样式，[敬请见证](https://segmentfault.com/a/1190000040213084#comment-area)。

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021208604.png "来自 DOS 时代的图标，你老爹那辈都不一定见过")

后来的事情我们也知道，win10 每年两个大版本更新，次次更新都多出一堆毛病，好不容易修得差不多，UI 将近统一，win11 来了。

win11 出来后，无数人又开始怀念 win10 ， **但请记住，这并不是因为 win10 做的有多好，而是因为 win11 甚至做得更糟。** 微软喜闻乐见地又改了设计，依然换汤不换药，顺带把刚有所好转的设计割裂问题彻底变成了不治之症：

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021216343.png "八个使用了新设计的系统程序，个个长得不一样")

到此为止，相信你也已经了解，寄希望于微软把系统推翻重做，重塑设计，无异于天方夜谭，倒不如我们自己动手，丰衣足食。当然，如果以上的问题你都能接受，那倒也无需继续折腾。对我而言，颜值是第一生产力，整日面对一个丑陋的系统会显著降低我的热情和效率，所以，既然美化和改进 UI，能让我获得更好的浏览体验，提高我的效率，那对我来讲，这就是一个有必要施行的工程。如果你也抱持类似的观点，或者只是单纯希望自己的 PC 能更加赏心悦目，那么，我确信你应当继续读下去。

事不宜迟，我们马上动手。

::: tip

本系列所有内容仅针对 win10/11 系统，其他系统请自行判断方案是否兼容。

:::

## 改造思路

在开始之前，我们必须强调， **系统级别的美化同样是一个系统工程，过程中一定会遇到大大小小的各种问题，这要求操作者具有一定的常识，和自行解决一部分问题的能力，如果你不具备这种基本能力，我建议你三思而后行。**

其次，在动手之前， **我们必须先确定美化的方向和风格，并在改造过程中从始至终贯彻（否则你干的事情就和微软没有区别）。** 我见过很多美化领域的所谓“老手”，既没有自己的审美，也不愿意采用现有的设计风格，只会把自己觉得好的东西乱加一气，丝毫不考虑整体的协调性和统一性，改完之后对着辣眼睛的杀马特桌面沾沾自喜，实际用起来还不如默认系统。在下文，我会列出自己在改造过程中坚持的数条原则，各位可以参考，也可以确定另外的方向，但无论如何，请记住，有方向才是最重要的一步。

我的美化原则：

- 系统层级的美化尽量遵循 Windows 目前的 Fluent Design 设计语言，以达到协调统一的视觉效果。

- 遵循剃刀定律——如无必要，勿增实体。一切的功能和效果尽量使用原生方式实现，在无法实现或有困难的情况下，再考虑引入第三方程序。

- 性能>美化，一切美化效果必须控制对系统性能和运行效率的影响，轻量化、无感化。如果某些效果兼容性不佳，或严重影响系统性能，应当直接舍弃，或采用其他替代方案。

- 功能>美化，美化是为了具体的功能服务，而不是让 PC 成为“美丽废物”。如果某种美化效果会对工作流产生负面影响，或是对系统内的文本阅读、图标辨识等视觉信息识别造成不良影响，应当进行改良，或采用其他替代方案。

絮絮叨叨说完这些，我们终于要进入正题，本文是系列的第一节，那么，我们就先从最底层的部分开始改起。

## 更彻底的 Fluent Design

### 开始菜单、设置、文件资源管理器

上文提到，Fluent Design 是 Windows 系广受好评的设计语言，然而，即使在 win10/11 中，这些全新的视觉效果仍然没有处处落实，我们先解决这些部分。

在工具的选择上，我推荐[MToolBox](https://winmoes.com/tools/12948.html)，内置多个实用美化开关，全图形化设计，简单方便。更重要的是，其实现方式并不具有明显的侵入性，不会像许多以往的许多美化工具，需要破解系统文件、安装各种各样的补丁。要实现其效果，只需要安装后允许开机自启，在后台挂一个 10MB 左右的拓展进程即可，符合我们“性能>美化”的原则。

装好后，我们首先来到主界面，点击“注册主服务”，让进程能够正常加载。完成后，点击左侧的“窗口设置”，分别在“开始菜单”和“系统设置”中勾选“启用 Acrylic 效果”，下面设置好的参数不用动，这样，你的开始菜单和系统设置页面就有了 Fluent Design 的亚克力效果。（是的，简单到难以置信，所以微软为什么不做？😡）

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021616026.png "猴子都能看懂的设置")

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021620476.png "具有亚克力半透明效果的 win11 设置界面")

接下来，我们可以尝试为文件资源管理器打开 Fluent Design 效果。开关在“窗口设置”的第一个界面，到这里，就有一些参数需要我们手动调整了。

首先，你可以自由选择材质效果，使用简单的[模糊]{Blur}，或是 Fluent Design 引入的半透明材质[亚克力]{Acrylic}，亦或是考虑到文字可读性，使用不透明的[云母]{Mica}材质都随你的心意，只是有几点需要注意：

文件资源管理器是一个以呈现文字信息为主，图像信息为辅的重要界面，因此调整时请务必先确保内容的可读性（功能>美化原则）。 **在类似的界面中，使用不透明的云母材质是最方便的选择，** 然而，如果你就是像我一样对半透明材质情有独钟，那么 **至少不要关闭下方的“添加混合颜色”的选项，并且不要将“窗口不透明度”调得太低，以防内容与背景混淆，难以辨认。**

到这里，对文件资源管理器的调整还没有完成——如果此时应用样式，打开管理器窗口，你会发现，下方的主窗口有效果，但上面的地址栏、工具栏等位置还是一片死白——我们还需要对这些位置做单独的调整。

现在，点击左侧的“控件样式”，来到“文件资源管理器”这一栏，先勾选右上方的“启用此页功能”，然后分别点进下方几个选项的背景色设置，现在，要做的事情只有一件——把“不透明度”往下拉即可。

拉到什么程度为好呢？要拉到让这些内容看起来跟与整个管理器的不透明度相匹配，不突兀，同时跟下方的主窗口又要有层级区分，不能混作一团。就我自己的视觉感受来说，在使用默认的亚克力材质效果下，所有颜色拉到 30% 是比较合适的（使用云母材质可适当上调）。同时，win11 用户记得勾选下方的“地址栏背景色跟随 Tab 标签颜色”， win10 用户则只用调整支持的选项即可。

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021710042.png "猴子都能看懂的设置 2")

![配图](https://image.you-xuan.us.kg/2024/10/02/202410021713988.png "默认亚克力 30%控件不透明度")

到这里，我们在 MToolBox 中的配置部分结束了，如果你有兴趣，也可以再试试其余的功能，接下来，我们再借助几个轻量级的插件，实现系统内其他部分的美化。

## 弹出菜单、任务栏、托盘菜单

这一步，我们需要的工具有[TranslucentFlyoutsConfig（弹出控件透明工具+控制页面）](https://github.com/Satanarious/TranslucentFlyoutsConfig/tree/master)、[TranslucentTB（任务栏透明化工具）](https://apps.microsoft.com/detail/9pf4kz2vn4w9?hl=zh-cn&gl=US)和[ExplorerPatcher（开始菜单+托盘菜单+右键菜单修改工具）](https://github.com/valinet/ExplorerPatcher)，基本的思路是先用 ExplorerPatcher 调整样式，再使用另外两个工具更改显示效果。

我们可以先从最简单的 TranslucentFlyouts 开始，该程序已经上架 Microsoft Store，能够直接搜索下载，安装后会显示在托盘菜单，只需要右键，选择需要的样式即可（支持将任务栏渲染为主题色，或改为亚克力、云母样式）。

**接下来的 ExplorerPatcher 则主要针对 win11 用户， win10 用户可以酌情安装。** 这个工具唯一的作用是让你能够一键切回以前的系统组件，最早支持到 win7，能做的事情包括但不限于在 win11 上使用 win10 的任务栏、使用 win10/win7 的开始菜单、使用 win10/win7 的音量控制样式（最近刚升完 win11，所以我确信一定会有人用得上这个的）……当然，这些功能最多只是锦上添花，之所以有必要列出这个工具，是因为我们要靠它干掉 win11 的右键菜单——不仅是因为它自作聪明的“改进”，还因为另一个工具，TranslucentFlyouts，只能对以 win32 方式渲染的弹出菜单生效。我们不需要知道这究竟是什么意思，只需要知道，win11 的右键菜单已经弃用了这种渲染方式，所以，我们得换回以前的右键菜单，才能实现我们想要的效果。 So，<abbr data-title="世界上真有人会喜欢右键后还需要“单击展开”的设计吗？🤔">如果你是 win11 右键菜单的忠实用户，</abbr> 下面的部分跳过就好。

从 TranslucentFlyoutsConfig 的[github release](https://github.com/Satanarious/TranslucentFlyoutsConfig/releases/tag/v1.4.2)页下载最新发行版后，解压所有文件到你想安装的文件夹，运行 `TranslucentFlyoutsConfig.exe` 这个可执行文件，再点击进入右上角的设置。移动到最下面的“外部功能” , 点击`下载并安装`按钮，即可完成安装。

::: tip
在第一次使用或系统大版本更新后，TranslucentFlyouts 会从微软服务器下载符号文件，以使一部分功能正常可用，正常联网，允许其下载即可。
:::

安装完成后的配置，各位可以参考 github 上的[使用说明](https://github.com/Satanarious/TranslucentFlyoutsConfig/blob/master/Readme/README-zh_cn.md#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E)。程序本身可以在设置中切换成中文（但是部分内容是机翻，相当难绷，比如 Acrylic 被翻译成了 “丙烯酸酯”，虽然这确实是“亚克力”没错……），除了能够将系统内的右键弹出菜单渲染成亚克力等样式，还支持自定义弹出动画，效果也相当不错，推荐一试。

![配图](https://image.you-xuan.us.kg/2024/10/02/202410022148712.gif "官方演示效果")

至此，Fluent Design 设计在我们的系统里得到了更彻底的贯彻，本篇内容便到此结束，本系列的下一篇，我们会把目光从系统组件转移到桌面和字体，来实现更进一步的美化，敬请期待。
